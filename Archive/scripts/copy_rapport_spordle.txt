function convertirEtImporterExcel() {
  var params = getParametres();
  var idDossier = params.idDossier ? params.idDossier.trim() : "";
  var searchInscriptions = params.nomFichierInscriptions ? params.nomFichierInscriptions.trim().toLowerCase() : "";
  var searchArticles = params.nomFichierArticles ? params.nomFichierArticles.trim().toLowerCase() : "";
  
  if (!idDossier || !searchInscriptions || !searchArticles) {
    SpreadsheetApp.getUi().alert("Les paramètres nécessaires (ID du dossier, noms de fichiers) ne sont pas définis.");
    return;
  }
  
  var dossier = DriveApp.getFolderById(idDossier);
  var fichiers = dossier.getFilesByType(MimeType.MICROSOFT_EXCEL);
  var ssCible = SpreadsheetApp.getActiveSpreadsheet();
  
  var nbFichiersTraites = 0;
  
  while (fichiers.hasNext()) {
    var fichierExcel = fichiers.next();
    var nomFichier = fichierExcel.getName().trim().toLowerCase();
    
    // Logs pour vérifier la comparaison
    Logger.log("----------");
    Logger.log("Fichier trouvé : [" + nomFichier + "]");
    Logger.log("Param Inscriptions : [" + searchInscriptions + "], indexOf => " + nomFichier.indexOf(searchInscriptions));
    Logger.log("Param Articles : [" + searchArticles + "], indexOf => " + nomFichier.indexOf(searchArticles));
    
    var ongletCible = "";
    if (nomFichier.indexOf(searchInscriptions) !== -1) {
      ongletCible = "INSCRIPTIONS";
    } else if (nomFichier.indexOf(searchArticles) !== -1) {
      ongletCible = "ARTICLES";
    } else {
      Logger.log("Fichier non reconnu : " + nomFichier);
      continue;
    }
    
    // Conversion Excel vers Google Sheets (nécessite l'API Drive activée)
    var blob = fichierExcel.getBlob();
    var fichierConverti;
    try {
      fichierConverti = Drive.Files.insert({
        title: fichierExcel.getName(),
        mimeType: MimeType.GOOGLE_SHEETS,
        parents: [{ id: fichierExcel.getParents().next().getId() }]
      }, blob, {convert: true});
    } catch(e) {
      Logger.log("Erreur lors de la conversion du fichier " + fichierExcel.getName() + " : " + e.message);
      continue;
    }
    
    var ssSource = SpreadsheetApp.openById(fichierConverti.id);
    var feuilleSource = ssSource.getSheets()[0]; // Première feuille par défaut
    var donnees = feuilleSource.getDataRange().getValues();
    
    var feuilleDestination = ssCible.getSheetByName(ongletCible);
    feuilleDestination.clearContents();
    
    // Préfixer la première colonne pour conserver le format (ex : pour garder les zéros en tête)
    donnees.forEach(function(row) {
      row[0] = "'" + row[0];
    });
    
    feuilleDestination.getRange(1, 1, donnees.length, donnees[0].length).setValues(donnees);
    
    // Nettoyage des fichiers temporaires
    try {
      DriveApp.getFileById(fichierExcel.getId()).setTrashed(true);
      DriveApp.getFileById(fichierConverti.id).setTrashed(true);
    } catch(e) {
      Logger.log("Erreur lors de la suppression des fichiers : " + e.message);
    }
    
    nbFichiersTraites++;
    Logger.log("Fichier traité : " + fichierExcel.getName() + " pour l'onglet " + ongletCible);
  }
  
  if (nbFichiersTraites === 0) {
    SpreadsheetApp.getUi().alert("Aucun fichier correspondant trouvé dans le dossier pour les noms définis.");
  } else {
    SpreadsheetApp.getUi().alert("Conversion et importation complétées (" + nbFichiersTraites + " fichier(s) traité(s)) !");
    envoyerSuiviCourriel()
  }
}
