<!-- <script>
// ------------ BOOT UNIQUE MINIMAL ------------
(function(){
  if (window.__BOOT_DONE__) return;   // anti double-inclusion si ui_embed + ui.html
  window.__BOOT_DONE__ = true;

  document.addEventListener('DOMContentLoaded', () => {
    // Laisse le temps au DOM d’être peint
    requestAnimationFrame(async () => {
      try { window.__bindUI?.(); } catch(_) {}
      try { await window.refreshSeasons?.(); } catch(_) {}
      // Route initiale et écoute
      try { window.routeTo ? routeTo(location.hash || '#/dashboard') : null; } catch(_) {}
      window.addEventListener('hashchange', () => { try { routeTo(location.hash); } catch(_) {} });
    });
  });

  // Helper: saison sélectionnée
  function _sid(){
    var el = document.getElementById('seasonSelect');
    return el && el.value ? String(el.value).trim() : '';
  }

  // Bouton "Réinitialiser saison" — déplacé ici au même boot
  document.addEventListener('DOMContentLoaded', function(){
    var btn = document.getElementById('btnResetSeason');
    if (!btn) return;
    btn.onclick = function(){
      var seasonId = _sid();
      if (!seasonId) { (window.toast ? toast('Aucune saison sélectionnée.') : alert('Aucune saison sélectionnée.')); return; }
      if (!confirm('Confirmer la réinitialisation des feuilles techniques pour cette saison ?')) return;

      // petit badge local
      var badge = document.getElementById('resetStatus');
      const busy = (on,msg)=>{ if (badge) badge.textContent = on ? (msg||'Exécution…') : ''; };
      busy(true,'Exécution…');

      google.script.run
        .withSuccessHandler(function(res){
          busy(false,'');
          if (!res || !res.ok){
            (window.toast ? toast(res && res.error || 'Échec réinitialisation','error') : alert(res && res.error || 'Échec réinitialisation'));
            return;
          }
          (window.toast ? toast('Réinitialisation complétée : ' + (res.data.cleared||[]).join(', ')) : alert('Réinitialisation complétée.'));
        })
        .withFailureHandler(function(err){
          busy(false,'');
          (window.toast ? toast(String(err),'error') : alert(String(err)));
        })
        .resetSeasonData(seasonId);
    };
  });
})();
</script> -->
