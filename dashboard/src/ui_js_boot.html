<script>
// Boot (séquence robuste)
document.addEventListener('DOMContentLoaded', () => {
  // Laisse le temps au DOM d’être peint
  requestAnimationFrame(() => {
    // 1) Binder tous les listeners d'UI ici (utilise safeOn/delegateOn si tu les as)
    window.__bindUI?.();

    // 2) Charger les saisons, PUIS le reste
    if (typeof window.refreshSeasons === 'function') {
      window.refreshSeasons(() => {
        // tout ce qui lit la saison active doit partir après refreshSeasons
        window.loadParamsForActiveSeason?.(false);
        window.loadRulesForActiveSeason?.(false);
        window.loadMappingList?.();
        window.autoLoadFirstMappingOnce?.();
      });
    } else {
      // fallback si refreshSeasons n’existe pas
      window.loadParamsForActiveSeason?.(false);
      window.loadRulesForActiveSeason?.(false);
      window.loadMappingList?.();
      window.autoLoadFirstMappingOnce?.();
    }
  });
});
</script>
